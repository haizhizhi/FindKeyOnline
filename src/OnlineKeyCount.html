<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ç½‘é¡µå…³é”®å­—æŸ¥è¯¢</title>
    <!--<script src="http://code.jquery.com/jquery-1.9.1.min.js" type="text/javascript"></script>-->
    <style>
        tr,table,td,th {
            border: 1px solid grey;
        }
        table{
            border: 1px solid grey;
            width:100%;
        }
    </style>
    <script>
        //è¯»å–æ–‡ä»¶
        function getCount()
        {
            var file=document.getElementById("file");
            var reader =new FileReader();
            reader.readAsText(file.files[0],"GBK");
            document.getElementById("scrollText").innerText="æ­£åœ¨è¯»å–æ–‡ä»¶å“¦ğŸ˜‚ğŸ˜‚";
            reader.onload=function(){
                document.getElementById("scrollText").innerText="è¯»å–æ–‡ä»¶å®ŒæˆğŸ™ƒğŸ™ƒğŸ™ƒğŸ™ƒ";
                analysis(this.result);
                document.getElementById("scrollText").innerText="ï¸ç»Ÿè®¡å®Œæˆå•¦â˜ºï¸â˜ºï¸";
            }
        }
        //è§£ææ–‡ä»¶
        function analysis(str){
            var rows=str.split(/\s+/);
            for(var i=0;i<rows.length;i++){
                var line=rows[i].split(",");
                var url=line[0];
                var key=line[1];
                count(url,key);
                document.getElementById("scrollText").innerText="æ­£åœ¨ç»Ÿè®¡è¯·ç¨ç­‰å“¦ğŸ˜¯ğŸ˜¯";
            }
        }
        //è®¡ç®—URLè¿”å›çš„HTMLåŒ…å«çš„å…³é”®å­—
        function count(url,key){
            var xhr = new XMLHttpRequest();
            xhr.open('get', url, true);
            xhr.dataType="html";
            xhr.send();
            xhr.onreadystatechange=function() {
                if (xhr.readyState == 4) {
                    if (xhr.status == 200) {
                        var count=countNumber(this.responseText,key);
                        // var keyWord=undefined;
                        // var progressBar=undefined;
                        appendHtml(url,key,count);
                    }else{
                        appendHtml(url,key,"è®¿é—®å¼‚å¸¸");
                    }
                }

            }
        }
        //è®¡ç®—å­—ç¬¦ä¸²ä¸­åŒ…å«çš„å…³é”®å­—
        function countNumber(str,key){
            var reg=new RegExp(key,"g");
            var result=str.match(reg);
            if(result==undefined){
                return 0;
            }else{
                return result.length;
            }
        }
        //ç”ŸæˆæŸ¥è¯¢çš„è¡¨æ ¼
        function appendHtml(url,key,count){
            var table=document.getElementById("tableContent");
            var tr=document.createElement("tr");
            tr.setAttribute("name","row");
            table.appendChild(tr);
            for(var i=0;i<arguments.length;i++){
                var td=document.createElement("td");
                td.innerText=arguments[i];
                tr.appendChild(td);
            }
        }
        //æ¸…ç©ºæŸ¥è¯¢åˆ—è¡¨
        function clearTable(){
            var nodes=document.getElementsByName("row");
            for(var i=nodes.length-1;i>=0;i--){
                nodes[i].remove();
            }
            document.getElementById("scrollText").innerText="å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦ğŸ˜ğŸ˜ğŸ˜ğŸ˜";
        }
    </script>
    </head>
<body>
<div>

</div>
<DIV style="float:left;width:33%;">
    <diV style="float:left;">
        <INPUT id="file" type="file" />
    </diV>
    <div style="float:RIGHT;">
        <button onclick="getCount()">å¼€å§‹ç»Ÿè®¡</button>
        <button onclick="clearTable()" style="margin-right:0px;">æ¸…ç©ºæŸ¥è¯¢åˆ—è¡¨</button>
        <!--<button>ä¸‹è½½</button>-->
    </div>
</DIV>
<DIV style="float:left;width:67%;">
    <marquee id="scrollText" behavior=alternate scrollamount=10 direction=right>å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦ğŸ˜ğŸ˜ğŸ˜ğŸ˜</marquee>
</DIV>
<table id="tableContent">
    <tr>
        <th>é“¾æ¥</th>
        <th>å…³é”®å­—</th>
        <th>ç»Ÿè®¡</th>
        <!--<th>keyWord</th>-->
        <!--<th>è¿›åº¦æ¡</th>-->
    </tr>
</table>
</body>

</html>